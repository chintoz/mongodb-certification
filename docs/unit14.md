# MongoDB Atlas Search

## Lesson 1: Using Relevance-Based Search and Search Indexes

Atlas search is a powerful tool created into MongoDB Atlas that allows you to create search experiences for users of your app without creating search algorithm.

### Relevance-Based Search

It's a kind of Atlas search within an application users seeks for surface records based on a search term. It's not a database search for a particular record. It's similar to a search bar on a website.

Search on different data types it's hard and sometimes external tools are used for that purpose. MnoDB Atlas Search is a tool that allows you to create search experiences for users of your app without creating search algorithm.

It's integrated Apache Lucene search engine that allows you to create search indexes and search queries.

Atlas search starts with search indexes which are no the same as database indexes. Database indexes are used by developers and database administrators to make their frequent database queries easier and more efficient. Search indexes specify how records are referenced for relevance-based search.


## Lesson 2: Creating a Search Index with Dynamic Mapping

Search index defines how a search should be performed. It's a set of rules that define how the search engine should interpret the data in the collection.

A search index with dynamic mapping means all fields indexed (except booleans, objectIds and timestamps) are indexed by default (even nested fields). This is useful when you have a large number of fields, and you don't want to create a mapping for each one.

By default index analyzer and search analyzer are going to be created using lucene standard analyzer. You can also specify a custom analyzer depends on your language or use case. 

If we specify dynamic mapping we don't need to specify any field mapping for this kind of indexes.

Once the index is created, we can do queries and it'll return the results a the score assigned to this search value. This search score is going to be generated by the search engine based on the relevance of the search term to the document.

In the following example we are going to create a search index with dynamic mapping on `birds` collection:

```mongodb-json
{
  "name": "sample_analytics-birds-dynamic",
  "searchAnalyzer": "lucene.standard",
  "analyzer": "lucene.standard",
  "collectionName": "birds",
  "database": "sample_analytics",
  "mappings": {
    "dynamic": true
  }
}
```

During the lab a search index was created using this command:

```bash
atlas clusters search indexes create --clusterName myAtlasClusterEDU -f /app/search_index.json
```

And it was queries using this one:

```bash
atlas clusters search indexes list --clusterName myAtlasClusterEDU --db sample_supplies --collection sales
```

Furthermore in the lab it was created a search on seach index using this sample:

```javascript
db = db.getSiblingDB("sample_supplies")

var pipeline = [
{
  "$search": {
    index: "sample_supplies-sales-dynamic",
    text: {
      query: "notepad", 
      path: { "wildcard": "*" }
    } } },
{
  "$set": {
    score: { 
      "$meta": "searchScore" }
    }
}
]

var result = db.sales.aggregate(pipeline)

print(result)
```
## Lesson 3: Creating a Search Index with Static Field Mapping

TBC

## Lesson 4: Using $search and Compound Operators

TBC

## Lesson 5: Group Search Results by Using Facets

TBC

